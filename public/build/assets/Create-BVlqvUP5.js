import{s as k,r as h,c as w,a as C,w as S,d as t,e as c,f as n,i as q,u as d,o as a,F as p,g as m,t as r,y as v,v as A}from"./app-DhMa9BIp.js";import{A as F}from"./AuthLayout-BITznstG.js";import"./x-CEVAYI9T.js";import"./circle-alert-PEU5T2pF.js";const V={class:"max-w-5xl mx-auto p-6 bg-white shadow rounded-lg"},P={class:"grid grid-cols-2 gap-6 mb-6"},T=["value"],$={key:0,class:"text-red-500 text-sm"},B={class:"flex gap-2"},U=["value"],D={class:"w-full border-collapse border mb-6 text-left"},E={class:"border p-2"},L={class:"border p-2"},M={class:"border p-2"},N=["onUpdate:modelValue"],j={class:"border p-2"},I=["onClick"],O={class:"flex justify-between items-center"},Q={class:"text-2xl font-bold"},R=["disabled"],K={__name:"Create",props:{customers:Array,products:Array},setup(u){const x=u,o=k({customer_id:"",items:[],total:0}),i=h(""),y=()=>{if(!i.value)return;const l=x.products.find(e=>e.id===i.value);if(l.stock_quantity<=0){toastr.error("Out of stock!");return}const s=o.items.find(e=>e.id===l.id);s?s.qty++:o.items.push({id:l.id,name:l.name,sale_price:parseFloat(l.sale_price),stock:l.stock_quantity,qty:1}),i.value=""},b=w(()=>o.items.reduce((l,s)=>l+s.qty*s.sale_price,0)),g=()=>{o.total=b.value,o.post("/sales",{onSuccess:()=>toastr.success("Sale Completed!"),onError:()=>toastr.error("Check form errors")})};return(l,s)=>(a(),C(F,null,{default:S(()=>[t("div",V,[s[7]||(s[7]=t("h1",{class:"text-2xl font-bold mb-6"},"Create Sale",-1)),t("div",P,[t("div",null,[s[3]||(s[3]=t("label",{class:"block font-bold"},"Customer",-1)),c(t("select",{"onUpdate:modelValue":s[0]||(s[0]=e=>d(o).customer_id=e),class:"w-full border p-2 rounded"},[s[2]||(s[2]=t("option",{value:"",disabled:"",selected:""},"-- Select Customer --",-1)),(a(!0),n(p,null,m(u.customers,e=>(a(),n("option",{key:e.id,value:e.id},r(e.name),9,T))),128))],512),[[v,d(o).customer_id]]),d(o).errors.customer_id?(a(),n("div",$,r(d(o).errors.customer_id),1)):q("",!0)]),t("div",null,[s[5]||(s[5]=t("label",{class:"block font-bold"},"Add Product",-1)),t("div",B,[c(t("select",{"onUpdate:modelValue":s[1]||(s[1]=e=>i.value=e),class:"w-full border p-2 rounded"},[s[4]||(s[4]=t("option",{value:""},"-- Select Product --",-1)),(a(!0),n(p,null,m(u.products,e=>(a(),n("option",{key:e.id,value:e.id},r(e.name)+" ($"+r(e.sale_price)+") - Stock: "+r(e.stock_quantity),9,U))),128))],512),[[v,i.value]]),t("button",{onClick:y,class:"bg-blue-600 text-white px-4 rounded"},"Add")])])]),t("table",D,[s[6]||(s[6]=t("thead",null,[t("tr",{class:"bg-gray-100"},[t("th",{class:"border p-2"},"Product"),t("th",{class:"border p-2"},"Price"),t("th",{class:"border p-2"},"Qty"),t("th",{class:"border p-2"},"Total"),t("th",{class:"border p-2"},"Action")])],-1)),t("tbody",null,[(a(!0),n(p,null,m(d(o).items,(e,_)=>(a(),n("tr",{key:_},[t("td",E,r(e.name),1),t("td",L,"$"+r(e.sale_price),1),t("td",M,[c(t("input",{type:"number","onUpdate:modelValue":f=>e.qty=f,class:"w-20 border rounded text-center"},null,8,N),[[A,e.qty,void 0,{number:!0}]])]),t("td",j,"$"+r((e.qty*e.sale_price).toFixed(2)),1),t("td",{class:"border p-2 text-center text-red-600 cursor-pointer",onClick:f=>d(o).items.splice(_,1)}," Remove ",8,I)]))),128))])]),t("div",O,[t("h2",Q,"Total: $"+r(b.value.toFixed(2)),1),t("button",{onClick:g,disabled:d(o).processing||d(o).items.length===0,class:"bg-green-600 text-white px-8 py-2 rounded font-bold"},r(d(o).processing?"Saving...":"Submit Sale"),9,R)])])]),_:1}))}};export{K as default};
