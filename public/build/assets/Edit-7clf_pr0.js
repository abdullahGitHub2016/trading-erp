import{m as S,s as P,f as n,b as i,u as l,h as U,w,d as t,q,j as f,t as u,x as A,e as b,i as v,o as d,F as h,g as _,y,v as g}from"./app-DhMa9BIp.js";import{A as T}from"./AuthLayout-BITznstG.js";import{A as j,C as E,S as F}from"./save-CAqfr8ZT.js";import{P as I,T as $}from"./trash-2-Be6CLe4a.js";import"./x-CEVAYI9T.js";import"./circle-alert-PEU5T2pF.js";const B={class:"max-w-6xl mx-auto py-6"},D={class:"mb-8 flex items-center justify-between"},O={class:"bg-slate-100 px-4 py-2 rounded-xl border border-slate-200"},L={class:"font-mono font-bold text-slate-700"},M={class:"bg-white p-8 rounded-3xl border border-slate-200 shadow-sm grid grid-cols-1 md:grid-cols-2 gap-8"},Q={class:"space-y-2"},R=["value"],z={key:0,class:"text-red-500 text-xs font-bold"},G={class:"space-y-2"},H={class:"bg-white rounded-3xl border border-slate-200 shadow-sm overflow-hidden"},J={class:"p-6 border-b border-slate-50 flex justify-between items-center bg-slate-50/30"},K={class:"overflow-x-auto"},W={class:"w-full text-left"},X={class:"divide-y divide-slate-50"},Y={class:"p-3"},Z=["onUpdate:modelValue","onChange"],tt=["value"],et={class:"p-3"},st=["onUpdate:modelValue"],ot={class:"p-3"},lt=["onUpdate:modelValue"],at={class:"p-3 text-right font-black text-slate-800"},rt={class:"p-3 text-center"},nt=["onClick"],dt={class:"p-8 bg-slate-900 text-white flex flex-col md:flex-row justify-between items-center"},it={class:"flex items-center gap-5"},ut={class:"p-4 bg-blue-500/10 rounded-2xl border border-blue-500/20"},ct={class:"text-4xl font-black text-white leading-none"},pt=["disabled"],gt=S({__name:"Edit",props:{purchase:{},suppliers:{},products:{}},setup(m){const c=m,o=P({supplier_id:c.purchase.supplier_id,purchase_date:c.purchase.purchase_date,items:c.purchase.items.map(a=>{const e=Number(a.quantity||0),s=Number(a.unit_price||0);return{product_id:a.product_id,quantity:e,unit_price:s,subtotal:e*s}}),total_amount:Number(c.purchase.total_amount||0)}),k=()=>{o.items.push({product_id:"",quantity:1,unit_price:0,subtotal:0})},N=a=>{o.items.length>1&&(o.items.splice(a,1),x())},C=a=>{const e=c.products.find(s=>Number(s.id)===Number(o.items[a].product_id));e&&(o.items[a].unit_price=Number(e.price),x())},x=()=>{let a=0;o.items.forEach(e=>{const s=Number(e.quantity||0),p=Number(e.unit_price||0);e.subtotal=s*p,a+=e.subtotal}),o.total_amount=a},V=()=>{o.put(`/purchases/${c.purchase.id}`)};return(a,e)=>(d(),n(h,null,[i(l(U),{title:"Edit Purchase Order"}),i(T,null,{default:w(()=>[t("div",B,[t("div",D,[t("div",null,[i(l(q),{href:"/purchases",class:"text-blue-600 flex items-center gap-1 text-sm font-bold hover:underline mb-1"},{default:w(()=>[i(l(j),{class:"w-4 h-4"}),e[2]||(e[2]=f(" Back to Purchases ",-1))]),_:1}),e[3]||(e[3]=t("h1",{class:"text-3xl font-black text-slate-900 tracking-tight"},"Edit Order",-1))]),t("div",O,[e[4]||(e[4]=t("p",{class:"text-[10px] font-black text-slate-400 uppercase tracking-widest"},"Reference No.",-1)),t("p",L,u(m.purchase.purchase_no),1)])]),t("form",{onSubmit:A(V,["prevent"]),class:"space-y-6"},[t("div",M,[t("div",Q,[e[6]||(e[6]=t("label",{class:"text-xs font-black uppercase text-slate-500 tracking-wider"},"Supplier",-1)),b(t("select",{"onUpdate:modelValue":e[0]||(e[0]=s=>l(o).supplier_id=s),class:"w-full rounded-xl border-slate-200 focus:ring-blue-500 p-3 bg-slate-50 border-none shadow-inner"},[e[5]||(e[5]=t("option",{value:""},"Choose a Supplier",-1)),(d(!0),n(h,null,_(m.suppliers,s=>(d(),n("option",{key:s.id,value:s.id},u(s.name),9,R))),128))],512),[[y,l(o).supplier_id]]),l(o).errors.supplier_id?(d(),n("p",z,u(l(o).errors.supplier_id),1)):v("",!0)]),t("div",G,[e[7]||(e[7]=t("label",{class:"text-xs font-black uppercase text-slate-500 tracking-wider"},"Order Date",-1)),b(t("input",{type:"date","onUpdate:modelValue":e[1]||(e[1]=s=>l(o).purchase_date=s),class:"w-full rounded-xl border-slate-200 focus:ring-blue-500 p-3 bg-slate-50 border-none shadow-inner"},null,512),[[g,l(o).purchase_date]])])]),t("div",H,[t("div",J,[e[9]||(e[9]=t("h3",{class:"font-bold text-slate-800"},"Items & Quantities",-1)),t("button",{type:"button",onClick:k,class:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-xl text-sm font-bold flex items-center gap-2 transition"},[i(l(I),{class:"w-4 h-4"}),e[8]||(e[8]=f(" Add Row ",-1))])]),t("div",K,[t("table",W,[e[11]||(e[11]=t("thead",{class:"bg-slate-50/50"},[t("tr",{class:"text-[10px] uppercase font-black text-slate-400 tracking-widest border-b border-slate-100"},[t("th",{class:"p-4"},"Product Selection"),t("th",{class:"p-4 w-32 text-center"},"Quantity"),t("th",{class:"p-4 w-40 text-right"},"Unit Price"),t("th",{class:"p-4 w-40 text-right"},"Subtotal"),t("th",{class:"p-4 w-12"})])],-1)),t("tbody",X,[(d(!0),n(h,null,_(l(o).items,(s,p)=>(d(),n("tr",{key:p},[t("td",Y,[b(t("select",{"onUpdate:modelValue":r=>s.product_id=r,onChange:r=>C(p),class:"w-full border-none focus:ring-0 bg-transparent rounded-lg"},[e[10]||(e[10]=t("option",{value:""},"Search Product...",-1)),(d(!0),n(h,null,_(m.products,r=>(d(),n("option",{key:r.id,value:r.id},u(r.name),9,tt))),128))],40,Z),[[y,s.product_id]])]),t("td",et,[b(t("input",{type:"number","onUpdate:modelValue":r=>s.quantity=r,onInput:x,min:"1",class:"w-full border-none focus:ring-0 bg-slate-50 rounded-lg text-center font-bold"},null,40,st),[[g,s.quantity]])]),t("td",ot,[b(t("input",{type:"number",step:"0.01","onUpdate:modelValue":r=>s.unit_price=r,onInput:x,class:"w-full border-none focus:ring-0 bg-slate-50 rounded-lg text-right font-mono"},null,40,lt),[[g,s.unit_price]])]),t("td",at," $"+u(Number(s.subtotal||0).toFixed(2)),1),t("td",rt,[l(o).items.length>1?(d(),n("button",{key:0,type:"button",onClick:r=>N(p),class:"text-slate-300 hover:text-red-500 transition"},[i(l($),{class:"w-4 h-4"})],8,nt)):v("",!0)])]))),128))])])]),t("div",dt,[t("div",it,[t("div",ut,[i(l(E),{class:"w-8 h-8 text-blue-400"})]),t("div",null,[e[12]||(e[12]=t("p",{class:"text-[10px] font-black uppercase text-slate-500 tracking-widest mb-1"},"Total Amount Due",-1)),t("p",ct," $"+u(Number(l(o).total_amount||0).toFixed(2)),1)])]),t("button",{type:"submit",disabled:l(o).processing,class:"w-full md:w-auto bg-blue-500 hover:bg-blue-400 text-white px-12 py-5 rounded-2xl font-black shadow-xl shadow-blue-500/20 transition-all active:scale-95 disabled:opacity-50 flex items-center justify-center gap-3"},[i(l(F),{class:"w-6 h-6"}),f(" "+u(l(o).processing?"Updating...":"Save Purchase Order"),1)],8,pt)])])],32)])]),_:1})],64))}});export{gt as default};
