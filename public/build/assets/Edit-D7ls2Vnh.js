import{s as g,z as w,r as k,c as q,a as C,w as F,d as t,t as n,e as p,u as i,f as r,o as l,F as m,g as _,y as f,v as A}from"./app-DhMa9BIp.js";import{A as U}from"./AuthLayout-BITznstG.js";import"./x-CEVAYI9T.js";import"./circle-alert-PEU5T2pF.js";const V={class:"max-w-5xl mx-auto p-6 bg-white shadow rounded-lg"},B={class:"text-2xl font-bold mb-6"},E={class:"grid grid-cols-2 gap-4 mb-6"},S=["value"],T={class:"flex gap-2"},M=["value"],$={class:"w-full border mb-6"},j={class:"p-2 border"},D={class:"p-2 border"},L=["onUpdate:modelValue"],z=["onClick"],I={class:"flex justify-between items-center"},N={class:"text-xl font-bold"},H={__name:"Edit",props:{sale:Object,customers:Array,products:Array},setup(c){const d=c,o=g({customer_id:d.sale.customer_id,items:[],total:d.sale.grand_total});w(()=>{d.sale.items.forEach(s=>{o.items.push({id:s.product_id,name:s.product.name,sale_price:parseFloat(s.unit_price),qty:s.quantity})})});const u=k(""),v=()=>{const s=d.products.find(a=>a.id===u.value);s&&o.items.push({id:s.id,name:s.name,sale_price:parseFloat(s.sale_price),qty:1})},x=q(()=>{const s=o.items.reduce((a,e)=>a+e.qty*e.sale_price,0);return o.total=s,s}),y=()=>{o.put(`/sales/${d.sale.id}`)};return(s,a)=>(l(),C(U,null,{default:F(()=>[t("div",V,[t("h1",B,"Edit Sale #"+n(c.sale.invoice_no),1),t("div",E,[p(t("select",{"onUpdate:modelValue":a[0]||(a[0]=e=>i(o).customer_id=e),class:"border p-2"},[(l(!0),r(m,null,_(c.customers,e=>(l(),r("option",{key:e.id,value:e.id},n(e.name),9,S))),128))],512),[[f,i(o).customer_id]]),t("div",T,[p(t("select",{"onUpdate:modelValue":a[1]||(a[1]=e=>u.value=e),class:"border p-2 flex-1"},[(l(!0),r(m,null,_(c.products,e=>(l(),r("option",{key:e.id,value:e.id},n(e.name),9,M))),128))],512),[[f,u.value]]),t("button",{onClick:v,class:"bg-blue-600 text-white px-4"},"Add")])]),t("table",$,[(l(!0),r(m,null,_(i(o).items,(e,b)=>(l(),r("tr",{key:b},[t("td",j,n(e.name),1),t("td",D,[p(t("input",{type:"number","onUpdate:modelValue":h=>e.qty=h,class:"w-20 border"},null,8,L),[[A,e.qty]])]),t("td",{class:"p-2 border text-red-500 cursor-pointer",onClick:h=>i(o).items.splice(b,1)},"Remove",8,z)]))),128))]),t("div",I,[t("h2",N,"Total: $"+n(x.value.toFixed(2)),1),t("button",{onClick:y,class:"bg-orange-500 text-white px-6 py-2 rounded"},"Update Sale")])])]),_:1}))}};export{H as default};
