import{m as V,s as N,f as r,b as i,u as o,h as U,w as g,d as t,q as I,j as x,x as T,e as p,i as w,n as q,o as n,F as m,g as _,t as u,y as v,v as h}from"./app-DhMa9BIp.js";import{A as j}from"./AuthLayout-BITznstG.js";import{A,C as F,S as $}from"./save-CAqfr8ZT.js";import{P as B,T as D}from"./trash-2-Be6CLe4a.js";import"./x-CEVAYI9T.js";import"./circle-alert-PEU5T2pF.js";const L={class:"max-w-6xl mx-auto"},M={class:"flex items-center justify-between mb-8"},E={class:"bg-white p-8 rounded-3xl border border-slate-200 shadow-sm grid grid-cols-1 md:grid-cols-2 gap-6"},O={class:"space-y-2"},z=["value"],G={key:0,class:"text-red-500 text-xs mt-1"},Q={class:"space-y-2"},R={class:"bg-white rounded-3xl border border-slate-200 shadow-sm overflow-hidden"},H={class:"p-6 border-b border-slate-100 bg-slate-50/50 flex justify-between items-center"},J={class:"overflow-x-auto"},K={class:"w-full text-left border-collapse"},W={class:"divide-y divide-slate-50"},X={class:"p-4"},Y=["onUpdate:modelValue","onChange"],Z=["value"],tt={class:"p-4"},et=["onUpdate:modelValue"],st={class:"p-4"},ot={class:"relative"},lt=["onUpdate:modelValue"],at={class:"p-4 text-right font-black text-slate-700"},rt={class:"p-4 text-center"},nt=["onClick"],dt={class:"p-8 bg-slate-900 text-white flex flex-col md:flex-row justify-between items-center gap-6"},it={class:"flex items-center gap-4"},ut={class:"p-3 bg-white/10 rounded-2xl"},ct={class:"text-3xl font-black"},pt=["disabled"],gt=V({__name:"Create",props:{suppliers:{},products:{}},setup(f){const y=f,s=N({supplier_id:"",purchase_date:new Date().toISOString().split("T")[0],note:"",items:[{product_id:"",quantity:1,unit_price:0,subtotal:0}],total_amount:0}),k=()=>{s.items.push({product_id:"",quantity:1,unit_price:0,subtotal:0})},C=d=>{s.items.length>1&&(s.items.splice(d,1),b())},S=d=>{const e=s.items[d].product_id;if(!e)return;const l=y.products.find(c=>Number(c.id)===Number(e));l&&(s.items[d].unit_price=Number(l.price),b())},b=()=>{let d=0;s.items.forEach(e=>{e.subtotal=Number(e.quantity)*Number(e.unit_price),d+=e.subtotal}),s.total_amount=d},P=()=>{s.post("/purchases",{onSuccess:()=>s.reset()})};return(d,e)=>(n(),r(m,null,[i(o(U),{title:"Create Purchase"}),i(j,null,{default:g(()=>[t("div",L,[t("div",M,[t("div",null,[i(o(I),{href:"/purchases",class:"text-blue-600 flex items-center gap-1 text-sm font-bold mb-2 hover:underline"},{default:g(()=>[i(o(A),{class:"w-4 h-4"}),e[2]||(e[2]=x(" Back to List ",-1))]),_:1}),e[3]||(e[3]=t("h1",{class:"text-3xl font-black text-slate-900"},"New Purchase Order",-1))])]),t("form",{onSubmit:T(P,["prevent"]),class:"space-y-6"},[t("div",E,[t("div",O,[e[5]||(e[5]=t("label",{class:"text-sm font-bold text-slate-700"},"Supplier",-1)),p(t("select",{"onUpdate:modelValue":e[0]||(e[0]=l=>o(s).supplier_id=l),class:q(["w-full rounded-xl border-slate-200 focus:ring-blue-500 focus:border-blue-500 p-3",{"border-red-500":o(s).errors.supplier_id}])},[e[4]||(e[4]=t("option",{value:""},"Select a Supplier",-1)),(n(!0),r(m,null,_(f.suppliers,l=>(n(),r("option",{key:l.id,value:l.id},u(l.name),9,z))),128))],2),[[v,o(s).supplier_id]]),o(s).errors.supplier_id?(n(),r("div",G,u(o(s).errors.supplier_id),1)):w("",!0)]),t("div",Q,[e[6]||(e[6]=t("label",{class:"text-sm font-bold text-slate-700"},"Purchase Date",-1)),p(t("input",{type:"date","onUpdate:modelValue":e[1]||(e[1]=l=>o(s).purchase_date=l),class:"w-full rounded-xl border-slate-200 focus:ring-blue-500 p-3"},null,512),[[h,o(s).purchase_date]])])]),t("div",R,[t("div",H,[e[8]||(e[8]=t("h2",{class:"font-bold text-slate-800"},"Purchase Items",-1)),t("button",{type:"button",onClick:k,class:"flex items-center gap-2 text-sm bg-blue-50 text-blue-600 px-4 py-2 rounded-lg font-bold hover:bg-blue-100 transition"},[i(o(B),{class:"w-4 h-4"}),e[7]||(e[7]=x(" Add Row ",-1))])]),t("div",J,[t("table",K,[e[11]||(e[11]=t("thead",null,[t("tr",{class:"text-[11px] uppercase font-black text-slate-400 tracking-widest border-b"},[t("th",{class:"p-4"},"Product"),t("th",{class:"p-4 w-32"},"Quantity"),t("th",{class:"p-4 w-44"},"Unit Price"),t("th",{class:"p-4 w-44 text-right"},"Subtotal"),t("th",{class:"p-4 w-16"})])],-1)),t("tbody",W,[(n(!0),r(m,null,_(o(s).items,(l,c)=>(n(),r("tr",{key:c},[t("td",X,[p(t("select",{"onUpdate:modelValue":a=>l.product_id=a,onChange:a=>S(c)},[e[9]||(e[9]=t("option",{value:""},"Choose Product",-1)),(n(!0),r(m,null,_(f.products,a=>(n(),r("option",{key:a.id,value:a.id},u(a.name),9,Z))),128))],40,Y),[[v,l.product_id]])]),t("td",tt,[p(t("input",{type:"number","onUpdate:modelValue":a=>l.quantity=a,onInput:b,min:"1",class:"w-full border-none focus:ring-0 bg-slate-50 rounded-lg text-center font-bold"},null,40,et),[[h,l.quantity]])]),t("td",st,[t("div",ot,[e[10]||(e[10]=t("span",{class:"absolute left-3 top-2.5 text-slate-400 text-sm"},"$",-1)),p(t("input",{type:"number","onUpdate:modelValue":a=>l.unit_price=a,onInput:b,step:"0.01",class:"w-full border-none focus:ring-0 bg-slate-50 rounded-lg pl-7 font-mono"},null,40,lt),[[h,l.unit_price]])])]),t("td",at," $"+u(l.subtotal.toFixed(2)),1),t("td",rt,[o(s).items.length>1?(n(),r("button",{key:0,type:"button",onClick:a=>C(c),class:"text-red-400 hover:text-red-600 transition"},[i(o(D),{class:"w-4 h-4"})],8,nt)):w("",!0)])]))),128))])])]),t("div",dt,[t("div",it,[t("div",ut,[i(o(F),{class:"w-8 h-8 text-blue-400"})]),t("div",null,[e[12]||(e[12]=t("p",{class:"text-slate-400 text-xs uppercase font-black tracking-widest"},"Grand Total",-1)),t("p",ct,"$"+u(o(s).total_amount.toFixed(2)),1)])]),t("button",{type:"submit",disabled:o(s).processing,class:"w-full md:w-auto flex items-center justify-center gap-2 bg-blue-500 hover:bg-blue-400 text-white px-10 py-4 rounded-2xl font-black transition shadow-xl shadow-blue-500/20 disabled:opacity-50"},[i(o($),{class:"w-5 h-5"}),x(" "+u(o(s).processing?"Saving...":"Confirm Purchase"),1)],8,pt)])])],32)])]),_:1})],64))}});export{gt as default};
