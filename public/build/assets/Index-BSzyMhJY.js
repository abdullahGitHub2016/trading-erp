import{r as g,c as B,a as N,w as P,b as c,d as t,u,h as z,e as _,v as D,f as d,o as i,F as v,g as x,i as T,t as b,n as k,j as y,k as q,l as C}from"./app-DhMa9BIp.js";import{A as I}from"./AuthLayout-BITznstG.js";import{S as M}from"./search-D0GS8zjR.js";import{S as R}from"./shield-check-wUVvdxGe.js";import{c as S,C as E}from"./x-CEVAYI9T.js";import"./circle-alert-PEU5T2pF.js";const F=S("ChevronDownIcon",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);const O=S("SquareCheckBigIcon",[["path",{d:"M21 10.5V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.5",key:"1uzm8b"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),G={class:"min-h-screen bg-slate-50 p-6"},H={class:"max-w-5xl mx-auto"},Q={class:"mb-8 flex flex-col md:flex-row md:items-center justify-between gap-4"},U={class:"relative"},J={class:"space-y-4"},K=["onClick"],W={class:"flex items-center gap-4"},X={class:"text-lg font-bold text-slate-800"},Y={key:0,class:"p-4 bg-slate-50/50 space-y-3"},Z={class:"flex items-center justify-between p-3 border-b border-slate-50"},ee=["onClick"],te=["onClick"],se={class:"p-4 grid grid-cols-2 md:grid-cols-3 gap-3"},oe=["checked","onChange"],ae={class:"text-xs text-slate-600 font-medium capitalize"},ue={__name:"Index",props:{roles:Array,groupedPermissions:Object},setup(w){const f=w,p=g(""),m=g(new Set([f.roles[0]?.id])),h=g(new Set),$=(a,s,e)=>{let o=a.permissions.map(r=>r.name);const l=e.map(r=>r.name);l.every(r=>o.includes(r))?o=o.filter(r=>!l.includes(r)):o=[...new Set([...o,...l])],C.put(`/admin/roles/${a.id}`,{permissions:o},{preserveScroll:!0})},L=B(()=>{if(!p.value)return f.groupedPermissions;const a={},s=p.value.toLowerCase();return Object.entries(f.groupedPermissions).forEach(([e,o])=>{const l=o.filter(n=>n.name.toLowerCase().includes(s));(l.length>0||e.toLowerCase().includes(s))&&(a[e]=l)}),a}),V=a=>m.value.has(a)?m.value.delete(a):m.value.add(a),j=(a,s)=>{const e=`${a}-${s}`;h.value.has(e)?h.value.delete(e):h.value.add(e)},A=(a,s)=>{let e=a.permissions.map(o=>o.name);e.includes(s)?e=e.filter(o=>o!==s):e.push(s),C.put(`/admin/roles/${a.id}`,{permissions:e},{preserveScroll:!0})};return(a,s)=>(i(),N(I,null,{default:P(()=>[c(u(z),{title:"Role Management"}),t("div",G,[t("div",H,[t("div",Q,[s[1]||(s[1]=t("div",null,[t("h1",{class:"text-2xl font-bold text-slate-900"},"Access Control List"),t("p",{class:"text-slate-500 text-sm"},"Define what each role can see and do.")],-1)),t("div",U,[c(u(M),{class:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400"}),_(t("input",{"onUpdate:modelValue":s[0]||(s[0]=e=>p.value=e),type:"text",placeholder:"Search permissions...",class:"pl-10 pr-4 py-2 bg-white border border-slate-200 rounded-xl text-sm focus:ring-2 focus:ring-indigo-500 outline-none w-full md:w-64 transition-all"},null,512),[[D,p.value]])])]),t("div",J,[(i(!0),d(v,null,x(w.roles,e=>(i(),d("div",{key:e.id,class:"bg-white rounded-2xl border border-slate-200 shadow-sm overflow-hidden"},[t("button",{onClick:o=>V(e.id),class:"w-full flex items-center justify-between p-5 hover:bg-slate-50 transition-colors"},[t("div",W,[c(u(R),{class:"w-6 h-6 text-indigo-600"}),t("span",X,b(e.name),1)]),c(u(F),{class:k([{"rotate-180":m.value.has(e.id)},"w-5 h-5 text-slate-300 transition-transform"])},null,8,["class"])],8,K),m.value.has(e.id)?(i(),d("div",Y,[(i(!0),d(v,null,x(L.value,(o,l)=>(i(),d("div",{key:l,class:"bg-white border border-slate-200 rounded-xl"},[t("div",Z,[t("button",{onClick:n=>j(e.id,l),class:"flex items-center gap-2 font-bold text-slate-700 capitalize text-sm"},[c(u(E),{class:k([{"rotate-90":h.value.has(`${e.id}-${l}`)},"w-4 h-4 transition-transform"])},null,8,["class"]),y(" "+b(l),1)],8,ee),t("button",{onClick:n=>$(e,l,o),class:"text-[10px] font-bold uppercase px-2 py-1 rounded hover:bg-indigo-50 text-indigo-600 transition-colors flex items-center gap-1"},[c(u(O),{class:"w-3 h-3"}),s[2]||(s[2]=y(" Toggle All ",-1))],8,te)]),_(t("div",se,[(i(!0),d(v,null,x(o,n=>(i(),d("label",{key:n.id,class:"flex items-center gap-2 p-2 rounded-lg hover:bg-slate-50 cursor-pointer border border-transparent hover:border-slate-100 transition-all"},[t("input",{type:"checkbox",checked:e.permissions.some(r=>r.id===n.id),onChange:r=>A(e,n.name),class:"w-4 h-4 text-indigo-600 rounded border-slate-300 focus:ring-indigo-500"},null,40,oe),t("span",ae,b(n.name.split(".")[1]||n.name),1)]))),128))],512),[[q,h.value.has(`${e.id}-${l}`)]])]))),128))])):T("",!0)]))),128))])])])]),_:1}))}};export{ue as default};
